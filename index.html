<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŒ World News | Ø§Ø®Ø¨Ø§Ø± Ø²Ù†Ø¯Ù‡</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  font-family:'Vazirmatn',sans-serif;
  margin:0; padding:0;
  direction:rtl;
  transition: background 2s;
  background:#f0f2f5;
}
header {
  background:linear-gradient(90deg,#1a1a2e,#0f3460);
  color:#fff; padding:20px;
  text-align:center; font-size:32px; font-weight:bold;
  position:sticky; top:0; z-index:100; transition: background 2s;
  box-shadow:0 4px 15px rgba(0,0,0,0.3);
}
nav {
  background:#16213e; display:flex; justify-content:center; flex-wrap:wrap;
  gap:10px; padding:12px; position:sticky; top:80px; z-index:99;
}
nav button {
  background:#0f3460; color:#fff; border:none; padding:10px 20px;
  cursor:pointer; border-radius:8px; font-size:16px; transition:0.4s;
}
nav button.active {
  background:#e94560; transform:scale(1.05);
  box-shadow:0 6px 15px rgba(0,0,0,0.3);
}
#search {
  display:block; width:85%; max-width:440px; margin:15px auto; padding:12px;
  border-radius:8px; border:1px solid #ccc; transition:0.3s; font-size:16px;
}
#search:focus { border-color:#0f3460; box-shadow:0 0 10px #0f3460; outline:none; }
.news-container { max-width:1024px; margin:auto; padding:20px; }
.news-item {
  background:#fff; margin-bottom:22px; padding:18px; border-radius:14px;
  box-shadow:0 4px 18px rgba(0,0,0,0.15); transition:all 0.5s; overflow:hidden;
  position:relative;
}
.news-item:hover { transform:translateY(-6px) scale(1.02); box-shadow:0 14px 28px rgba(0,0,0,0.25); }
.news-item img { width:100%; max-height:320px; object-fit:cover; border-radius:12px;
  margin-bottom:14px; transition:transform 0.5s, filter 0.5s; }
.news-item img:hover { transform:scale(1.06); filter:brightness(1.12); }
.news-item h3 { margin:12px 0; font-size:22px; color:#1a1a2e; transition:color 0.3s; }
.news-item:hover h3 { color:#e94560; }
.news-item p { font-size:16px; color:#333; line-height:1.6; }
.news-item a { display:inline-block; margin-top:12px; color:#0f3460; font-weight:bold; text-decoration:none; transition:0.3s; }
.news-item a:hover { color:#e94560; }
.slider {
  position:relative; overflow:hidden; border-radius:14px; margin-bottom:28px;
  box-shadow:0 6px 25px rgba(0,0,0,0.2);
}
.slide {
  min-width:100%; box-sizing:border-box; position:absolute; opacity:0;
  transform:translateX(100%); transition:opacity 1s ease, transform 1s ease;
}
.slide.active { opacity:1; transform:translateX(0); z-index:2; }
.slide img { width:100%; max-height:400px; object-fit:cover; border-radius:14px;
  filter:brightness(0.78); transition:filter 0.5s; }
.slide h2 {
  position:absolute; bottom:25px; right:25px; background:rgba(0,0,0,0.65);
  color:#fff; padding:14px; border-radius:10px; font-size:26px;
  animation:slideText 2.5s ease-in-out infinite alternate;
}
@keyframes slideText { 0%{transform:translateY(0);} 50%{transform:translateY(-6px);} 100%{transform:translateY(0);} }
@media(max-width:768px){ .news-item h3{ font-size:18px; } .news-item p{ font-size:14px; } .slide h2{ font-size:18px; } nav{flex-direction:column;} }
</style>
</head>
<body>
<header>ğŸŒ World News | Ø§Ø®Ø¨Ø§Ø± Ø²Ù†Ø¯Ù‡</header>
<nav>
  <button onclick="loadNews('bbc', this)" class="active">BBC</button>
  <button onclick="loadNews('cnn', this)">CNN</button>
  <button onclick="loadNews('aljazeera', this)">Al Jazeera</button>
  <button onclick="loadNews('afghan', this)">Ø§ÙØºØ§Ù†Ø³ØªØ§Ù†</button>
</nav>
<input type="text" id="search" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ø§Ø®Ø¨Ø§Ø±..." oninput="filterNews()">
<div class="news-container">
  <div class="slider" id="slider"></div>
  <div id="news"><p>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø®Ø¨Ø±Ù‡Ø§...</p></div>
</div>

<script>
let currentSource='bbc', newsItems=[], displayedCount=0, loading=false, slideIndex=0, slideInterval;

// Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ù¾ÙˆÛŒØ§ Ø¨Ø±Ø§ÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ùˆ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
const colors=['#f0f2f5','#fbe4c3','#c3fbe4','#e4c3fb','#c3d7fb','#fbc3c3'];
let colorIndex=0;
setInterval(()=>{
  document.body.style.background=colors[colorIndex];
  document.querySelector('header').style.background=`linear-gradient(90deg, ${colors[colorIndex]}, #0f3460)`;
  document.querySelectorAll('.news-item').forEach(item=>{
    item.style.background=colors[(colorIndex+1)%colors.length];
  });
  colorIndex=(colorIndex+1)%colors.length;
},5000);

// Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø®Ø¨Ø§Ø± Ø§Ø² RSS Ø¨Ø§ Ù¾Ø±ÙˆÚ©Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² CORS
async function loadNews(source, btn){
  currentSource=source; displayedCount=0; newsItems=[]; clearInterval(slideInterval);
  document.getElementById("news").innerHTML="<p>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø®Ø¨Ø±Ù‡Ø§...</p>";
  document.getElementById("slider").innerHTML="";
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  if(btn) btn.classList.add('active');

  const urls={
    bbc:"http://feeds.bbci.co.uk/persian/rss.xml",
    cnn:"http://rss.cnn.com/rss/edition.rss",
    aljazeera:"https://www.aljazeera.com/xml/rss/all.xml",
    afghan:"https://www.pajhwok.com/en/rss"
  };
  const url=urls[source]||urls.bbc;
  const proxy="https://api.allorigins.win/get?url="+encodeURIComponent(url);

  try{
    const res=await fetch(proxy);
    const data=await res.json();
    const parser=new DOMParser();
    const xml=parser.parseFromString(data.contents,"text/xml");
    xml.querySelectorAll("item").forEach(item=>{
      const title=item.querySelector("title")?.textContent||"";
      const link=item.querySelector("link")?.textContent||"#";
      const desc=item.querySelector("description")?.textContent||"";
      const media=item.querySelector("media\\:content, enclosure");
      const image=media?.getAttribute("url")||"";
      newsItems.push({title,link,desc,image});
    });
    setupSlider(); loadMoreNews();
  }catch(err){ 
    document.getElementById("news").innerHTML="<p>Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø®Ø¨Ø±Ù‡Ø§.</p>"; 
    console.error(err);
  }
}

// Ù†Ù…Ø§ÛŒØ´ Ø§Ø®Ø¨Ø§Ø± Ø¨Ù‡ ØªØ¹Ø¯Ø§Ø¯ Ù…Ø´Ø®Øµ
function displayNews(start,count){
  const newsDiv=document.getElementById("news");
  for(let i=start;i<start+count && i<newsItems.length;i++){
    const item=newsItems[i];
    const newsItem=document.createElement("div");
    newsItem.className="news-item";
    newsItem.innerHTML=`${item.image?`<img src="${item.image}" alt="news image"/>`:""}
      <h3>${item.title}</h3>
      <p>${item.desc}</p>
      <a href="${item.link}" target="_blank">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ø§Ù…Ù„ Ø®Ø¨Ø±</a>`;
    newsDiv.appendChild(newsItem);
  }
  displayedCount+=count;
}

// Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¨ÛŒØ´ØªØ± Ù‡Ù†Ú¯Ø§Ù… Ø§Ø³Ú©Ø±ÙˆÙ„
function loadMoreNews(){
  if(loading) return; 
  loading=true; 
  displayNews(displayedCount,5); 
  loading=false;
}

window.addEventListener('scroll', ()=>{
  if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 100) loadMoreNews();
});

// Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§Ø³Ù„Ø§ÛŒØ¯Ø± Ú†Ù†Ø¯ ØªØµÙˆÛŒØ±ÛŒ
function setupSlider(){
  const sliderDiv=document.getElementById("slider"); 
  sliderDiv.innerHTML="";
  newsItems.slice(0,5).forEach((item,i)=>{
    const slide=document.createElement("div");
    slide.className="slide";
    if(i===0) slide.classList.add("active");
    slide.innerHTML=`${item.image?`<img src="${item.image}" alt="slide image"/>`:""}
      <h2>${item.title}</h2>`;
    sliderDiv.appendChild(slide);
  });
  slideIndex=0;
  clearInterval(slideInterval);
  slideInterval=setInterval(()=>{ nextSlide(); },4000);
}

function nextSlide(){
  const slides=document.querySelectorAll(".slide");
  slides.forEach(s=>s.classList.remove("active"));
  slideIndex=(slideIndex+1)%slides.length;
  slides[slideIndex].classList.add("active");
}

// Ø¬Ø³ØªØ¬ÙˆÛŒ Ø²Ù†Ø¯Ù‡ Ø§Ø®Ø¨Ø§Ø±
function filterNews(){
  const query=document.getElementById("search").value.toLowerCase();
  const newsDiv=document.getElementById("news");
  newsDiv.innerHTML="";
  newsItems.forEach(item=>{
    if(item.title.toLowerCase().includes(query) || item.desc.toLowerCase().includes(query)){
      const newsItem=document.createElement("div");
      newsItem.className="news-item";
      newsItem.innerHTML=`${item.image?`<img src="${item.image}" alt="news image"/>`:""}
        <h3>${item.title}</h3>
        <p>${item.desc}</p>
        <a href="${item.link}" target="_blank">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ø§Ù…Ù„ Ø®Ø¨Ø±</a>`;
      newsDiv.appendChild(newsItem);
    }
  });
}

// Ù„ÙˆØ¯ Ø§ÙˆÙ„ÛŒÙ‡ Ø§Ø®Ø¨Ø§Ø±
loadNews('bbc');
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸŒ World News | Ø§Ø®Ø¨Ø§Ø± Ø²Ù†Ø¯Ù‡</title>
<style>
body { font-family: "Tahoma", sans-serif; background: #f1f1f1; margin:0; padding:0; direction:rtl; }
header { background:#1a1a2e; color:#fff; padding:20px; text-align:center; font-size:26px; font-weight:bold; }
nav { background:#16213e; text-align:center; padding:10px; }
nav button { background:#0f3460; color:#fff; border:none; margin:5px; padding:10px 15px; cursor:pointer; border-radius:5px; }
.news-container { max-width:1000px; margin:auto; padding:20px; }
.news-item { background:#fff; margin-bottom:20px; padding:15px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); transition:all 0.3s; }
.news-item:hover { transform:scale(1.01); }
.news-item img { max-width:100%; border-radius:5px; margin-bottom:10px; }
#search { width:100%; padding:10px; margin-bottom:20px; border-radius:5px; border:1px solid #ccc; }
.social-share { margin-top:10px; }
.social-share a { margin:0 5px; text-decoration:none; color:#0f3460; font-weight:bold; }
.slider { max-width:1000px; margin:auto; overflow:hidden; position:relative; }
.slider-track { display:flex; transition:transform 0.5s ease; }
.slider-item { min-width:300px; margin:10px; background:#fff; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
.slider-item img { width:100%; border-radius:8px 8px 0 0; }
.slider-item h3 { padding:10px; font-size:18px; }
</style>
</head>
<body>
<header>ğŸŒ World News | Ø§Ø®Ø¨Ø§Ø± Ø²Ù†Ø¯Ù‡</header>
<div class="news-container">
<input type="text" id="search" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ø®Ø¨Ø±..." />
<div class="slider" id="slider">
<div class="slider-track" id="slider-track"></div>
</div>
<div id="news"></div>
</div>
<script>
const sources = {
  "bbc":"https://feeds.bbci.co.uk/persian/rss.xml",
  "cnn":"http://rss.cnn.com/rss/edition_rss.xml",
  "aljazeera":"https://www.aljazeera.com/xml/rss/all.xml",
  "afghanistan":"https://www.tolafghan.com/rss"
};

let newsItems=[];

async function fetchRSS(url){
  try{
    const proxy="https://api.allorigins.win/get?url="+encodeURIComponent(url);
    const res=await fetch(proxy);
    const data=await res.json();
    const parser=new DOMParser();
    const xml=parser.parseFromString(data.contents,"text/xml");
    const items=xml.querySelectorAll("item");
    items.forEach(item=>{
      const title=item.querySelector("title")?.textContent||"Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†";
      const link=item.querySelector("link")?.textContent||"#";
      const desc=item.querySelector("description")?.textContent||"";
      const media=item.querySelector("media\\:content, enclosure");
      const image=media?.getAttribute("url")||"";
      newsItems.push({title,link,desc,image});
    });
  }catch(err){console.log("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø®Ø¨Ø±Ù‡Ø§",err);}
}

async function loadNews(){
  newsItems=[];
  for(const key in sources){ await fetchRSS(sources[key]); }
  displayNews(newsItems);
  setupSlider(newsItems.filter(n=>n.image));
}
function displayNews(items){
  const newsDiv=document.getElementById("news");
  newsDiv.innerHTML="";
  items.forEach(item=>{
    const newsItem=document.createElement("div");
    newsItem.className="news-item";
    newsItem.innerHTML=`${item.image?`<img src="${item.image}" alt="news image"/>`:""}
      <h3>${item.title}</h3>
      <p>${item.desc}</p>
      <a href="${item.link}" target="_blank">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ø§Ù…Ù„ Ø®Ø¨Ø±</a>
      <div class="social-share">
        <a href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(item.link)}" target="_blank">Facebook</a>
        <a href="https://twitter.com/intent/tweet?url=${encodeURIComponent(item.link)}" target="_blank">Twitter</a>
        <a href="https://www.instagram.com/?url=${encodeURIComponent(item.link)}" target="_blank">Instagram</a>
        <a href="https://api.whatsapp.com/send?text=${encodeURIComponent(item.link)}" target="_blank">WhatsApp</a>
      </div>`;
    newsDiv.appendChild(newsItem);
  });
}
document.getElementById("search").addEventListener("input",e=>{
  const query=e.target.value.toLowerCase();
  displayNews(newsItems.filter(item=>item.title.toLowerCase().includes(query)||item.desc.toLowerCase().includes(query)));
});

// Ø§Ø³Ù„Ø§ÛŒØ¯Ø± Ø³Ø§Ø¯Ù‡
function setupSlider(sliderItems){
  const track=document.getElementById("slider-track");
  track.innerHTML="";
  sliderItems.forEach(item=>{
    const div=document.createElement("div");
    div.className="slider-item";
    div.innerHTML=`<img src="${item.image}" alt="news"/><h3>${item.title}</h3>`;
    track.appendChild(div);
  });
  let index=0;
  setInterval(()=>{ index=(index+1)%sliderItems.length; track.style.transform=`translateX(-${index*320}px)`; },3000);
}

// Ø¢Ù¾Ø¯ÛŒØª Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± 15 Ø¯Ù‚ÛŒÙ‚Ù‡
loadNews();
setInterval(loadNews,900000);
</script>
</body>
</html>
